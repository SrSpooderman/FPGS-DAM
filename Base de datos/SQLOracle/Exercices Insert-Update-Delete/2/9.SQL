SELECT P.NAME, C.TEAM_NAME, COUNT(CA.CALENDAR_ID) AS PLAYED_ENCOUNTERS, S.GOALS AS GOLES, MAX(PLAYED_ENCOUNTERS, GOLES)
FROM PLAYERS P
JOIN CLUBS C ON C.CLUB_ID = P.CLUB_ID
JOIN STATS S ON P.STAT_ID = S.STAT_ID
JOIN CALENDARS CA ON C.CLUB_ID = CA.FORAIGN_TEAM OR CA.LOCAL_TEAM
;