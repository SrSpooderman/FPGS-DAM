create
CREATE TABLE MANUFACTURERS(
    CODE INTEGER PRIMARY KEY,
    NAME_MAN VARCHAR2(50) NOT NULL
);

CREATE TABLE PRODUCTS(
    CODE INTEGER PRIMARY KEY,
    NAME_PRO VARCHAR2(50) NOT NULL,
    PRICE NUMBER(4) NOT NULL,
    MANUFACTURER INTEGER NOT NULL, 
    CONSTRAINT manufacturer_fk FOREIGN KEY (MANUFACTURER) REFERENCES MANUFACTURERS (CODE)
);

insert
INSERT INTO Manufacturers(Code,Name_man) VALUES(1,'Sony');
INSERT INTO Manufacturers(Code,Name_man) VALUES(2,'Creative Labs');
INSERT INTO Manufacturers(Code,Name_man) VALUES(3,'Hewlett-Packard');
INSERT INTO Manufacturers(Code,Name_man) VALUES(4,'Iomega');
INSERT INTO Manufacturers(Code,Name_man) VALUES(5,'Fujitsu');
INSERT INTO Manufacturers(Code,Name_man) VALUES(6,'Winchester');
INSERT INTO Products(Code,Name_pro,Price,Manufacturer) VALUES(1,'Hard drive',240,5);
INSERT INTO Products(Code,Name_pro,Price,Manufacturer) VALUES(2,'Memory',120,6);
INSERT INTO Products(Code,Name_pro,Price,Manufacturer) VALUES(3,'ZIP drive',150,4);
INSERT INTO Products(Code,Name_pro,Price,Manufacturer) VALUES(4,'Floppy disk',5,6);
INSERT INTO Products(Code,Name_pro,Price,Manufacturer) VALUES(5,'Monitor',240,1);
INSERT INTO Products(Code,Name_pro,Price,Manufacturer) VALUES(6,'DVD drive',180,2);
INSERT INTO Products(Code,Name_pro,Price,Manufacturer) VALUES(7,'CD drive',90,2);
INSERT INTO Products(Code,Name_pro,Price,Manufacturer) VALUES(8,'Printer',270,3);
INSERT INTO Products(Code,Name_pro,Price,Manufacturer) VALUES(9,'Toner cartridge',66,3);
INSERT INTO Products(Code,Name_pro,Price,Manufacturer) VALUES(10,'DVD burner',180,2);

1
SELECT P.NAME_PRO
from PRODUCTS P;

2
SELECT P.NAME_PRO, P.PRICE
from PRODUCTS P;

3
SELECT P.NAME_PRO
from PRODUCTS P
WHERE P.PRICE <= 200
;

4
SELECT P.NAME_PRO
from PRODUCTS P
WHERE P.PRICE BETWEEN 60 AND 120
;

5
SELECT P.NAME_PRO, P.PRICE*100 AS "PRICE IN CENT"
from PRODUCTS P;

6
SELECT AVG(P.PRICE)
from PRODUCTS P;

7
SELECT AVG(P.PRICE)
from PRODUCTS P
WHERE P.MANUFACTURER = 2;

8
SELECT COUNT(P.CODE)
from PRODUCTS P
WHERE P.PRICE >= 180;

9
SELECT P.NAME_PRO, P.PRICE
from PRODUCTS P
WHERE P.PRICE >= 180
ORDER BY P.PRICE DESC, P.NAME_PRO ASC
;

10
SELECT *
FROM PRODUCTS P
JOIN MANUFACTURERS M ON M.CODE = P.MANUFACTURER;

11
SELECT P.NAME_PRO, P.PRICE, M.NAME_MAN
FROM PRODUCTS P
JOIN MANUFACTURERS M ON P.MANUFACTURER = M.CODE;

12
SELECT AVG(P.PRICE), P.MANUFACTURER
FROM PRODUCTS P
GROUP BY P.MANUFACTURER, P.NAME_PRO
;

13
SELECT AVG(P.PRICE), m.NAME_MAN
FROM PRODUCTS P
join MANUFACTURERS m on p.MANUFACTURER = m.CODE
GROUP BY m.NAME_MAN, P.NAME_PRO
;

14
SELECT M.NAME_MAN
FROM (
    SELECT AVG(P.PRICE) AS AVERAGE_PROD, P.MANUFACTURER AS MANUFACTURES_OBJ
    FROM PRODUCTS P 
    GROUP BY P.MANUFACTURER
)
JOIN MANUFACTURERS M ON MANUFACTURES_OBJ = M.CODE
WHERE AVERAGE_PROD >= 150
;

15
SELECT P.NAME_PRO,P.PRICE
FROM PRODUCTS P
ORDER BY P.PRICE DESC
FETCH NEXT 1 ROWS ONLY;

16
SELECT P.NAME_PRO, M.NAME_MAN
FROM PRODUCTS P
JOIN MANUFACTURERS M ON M.CODE = P.MANUFACTURER
WHERE P.PRICE IN (SELECT MAXIMO FROM(SELECT max(P.price) AS MAXIMO, P.MANUFACTURER AS MANU FROM PRODUCTS P GROUP BY P.MANUFACTURER))
;

17
INSERT INTO Products(Code,Name_pro,Price,Manufacturer) VALUES(11,'Loudspeakers',70,2);

18
UPDATE PRODUCTS
SET NAME_PRO = 'Laser Printer'
WHERE code = 8;

19
UPDATE PRODUCTS
SET PRICE = (90*price)/100;

20
UPDATE PRODUCTS
SET PRICE = (90*price)/100
WHERE PRICE >= 120;