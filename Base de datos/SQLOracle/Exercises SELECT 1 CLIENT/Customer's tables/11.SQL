SELECT C.CUSTOMER_TYPE, P.PROVINCE_NAME, COUNT(PUR.PURCHASE_ID)
FROM CUSTOMERS C
JOIN PROVINCES P ON P.CODE = C.PROVINCE_CODE
JOIN PURCHASES PUR ON PUR.CLIENT = C.CUSTOMER_ID
GROUP BY C.CUSTOMER_TYPE, P.PROVINCE_NAME;